<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<script type="text/javascript" src="../../vimwiki-theme/code/theme/scripts/jquery-1.4.2.min.js"></script>

<link type="text/css" rel="stylesheet" href="../../vimwiki-theme/hightlight-code/styles/shCore.css"/>
<link type="text/css" rel="stylesheet" href="../../vimwiki-theme/hightlight-code/styles/shThemeDefault.css"/>
<script type="text/javascript" src="../../vimwiki-theme/hightlight-code/scripts/shCore.js"></script>
<script type="text/javascript" src="../../vimwiki-theme/hightlight-code/scripts/shAutoloader.js"></script>

<script type="text/javascript" src="../../vimwiki-theme/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/javascript" src="../../vimwiki-theme/code/theme/scripts/script.js"></script>
<link type="text/css" rel="stylesheet" href="../../vimwiki-theme/code/theme/styles/style.css" />


<title>Linux基本操作</title>
</head>
<body  onresize='changeTocSize()'>
	<div class="note-main"> 



<h1>Linux基本操作</h1>
<div class="toc">
<ul>
<li><a href="#toc_1">简单工具</a>
<ul>
<li><a href="#toc_1.1">mkpasswd</a>
</ul>
<li><a href="#toc_2">日期时间</a>
<ul>
<li><a href="#toc_2.1">cal</a>
<li><a href="#toc_2.2">date</a>
</ul>
<li><a href="#toc_3">别名</a>
<ul>
<li><a href="#toc_3.1">alias</a>
</ul>
<li><a href="#toc_4">通信</a>
<ul>
<li><a href="#toc_4.1">wall</a>
<li><a href="#toc_4.2">mesg</a>
<li><a href="#toc_4.3">write</a>
<li><a href="#toc_4.4">talk</a>
</ul>
<li><a href="#toc_5">系统信息</a>
<ul>
<li><a href="#toc_5.1">uptime</a>
<li><a href="#toc_5.2">uname</a>
<li><a href="#toc_5.3">issue</a>
<li><a href="#toc_5.4">w</a>
<li><a href="#toc_5.5">whereis</a>
</ul>
<li><a href="#toc_6">用户管理</a>
<li><a href="#toc_7">软件安装</a>
<li><a href="#toc_8">文件系统</a>
<li><a href="#toc_9">任务管理</a>
<ul>
<li><a href="#toc_9.1">jobs</a>
</ul>
<li><a href="#toc_10">进程管理</a>
<ul>
<li><a href="#toc_10.1">top</a>
<ul>
<li><a href="#toc_10.1.1">排序</a>
<li><a href="#toc_10.1.2">Display Specific User Process</a>
<li><a href="#toc_10.1.3">Highlight Running Process in Top</a>
<li><a href="#toc_10.1.4">Shows Absolute Path of Processes</a>
<li><a href="#toc_10.1.5">Change Delay or Set ‘Screen Refresh Interval’ in Top</a>
<li><a href="#toc_10.1.6">Kill running process</a>
<li><a href="#toc_10.1.7">Sort by CPU Utilisation</a>
<li><a href="#toc_10.1.8">Renice a Process</a>
<li><a href="#toc_10.1.9">Save Top Command Results</a>
</ul>
<li><a href="#toc_10.2">free</a>
<li><a href="#toc_10.3">kill</a>
<li><a href="#toc_10.4">pkill</a>
</ul>
<li><a href="#toc_11">服务</a>
<ul>
<li><a href="#toc_11.1">service</a>
</ul>
<li><a href="#toc_12">文件资源</a>
<ul>
<li><a href="#toc_12.1">lsof</a>
<ul>
<li><a href="#toc_12.1.1">List all Open Files with lsof Command</a>
<li><a href="#toc_12.1.2">List User Specific Opened Files</a>
<li><a href="#toc_12.1.3">Find Processes running on Specific Port</a>
<li><a href="#toc_12.1.4">List Only IPv4 &amp; IPv6 Open Files</a>
<li><a href="#toc_12.1.5">List Open Files of TCP Port ranges 1-1024</a>
<li><a href="#toc_12.1.6">Exclude User with ‘^’ Character</a>
<li><a href="#toc_12.1.7">Find Out who’s Looking What Files and Commands?</a>
<li><a href="#toc_12.1.8">List all Network Connections</a>
<li><a href="#toc_12.1.9">Search by PID</a>
<li><a href="#toc_12.1.10">Kill all Activity of Particular User</a>
</ul>
</ul>
<li><a href="#toc_13">文件操作</a>
<ul>
<li><a href="#toc_13.1">散列</a>
<li><a href="#toc_13.2">压缩</a>
<li><a href="#toc_13.3">查找</a>
</ul>
<li><a href="#toc_14">文本文件</a>
<ul>
<li><a href="#toc_14.1">paste</a>
<li><a href="#toc_14.2">比较</a>
<li><a href="#toc_14.3">编码与格式</a>
<ul>
<li><a href="#toc_14.3.1">ASCII</a>
<li><a href="#toc_14.3.2">生成16f进制</a>
<li><a href="#toc_14.3.3">字符编码</a>
<li><a href="#toc_14.3.4">换行</a>
</ul>
</ul>
</ul>
</div>

<h1 id="toc_1">简单工具</h1>

<h2 id="toc_1.1">mkpasswd</h2>

<p>
根据指定的长度，产生一个难猜的随机密码。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ mkpasswd -l 10
 
zI4+Ybqfx9
</pre>
	
<p>
注意：<code>-l 10</code>产生一个10个字符的随机密码，而<code>-l 20</code>产生20个字符的密码,它可以设置
为任意长度来取得所希望的结果。这个命令很有用，经常在脚本语言里使用来产生随机的
密码。你可能需要<code>yum</code>或<code>apt</code> <code>expect</code> 包来使用这个命令。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ yum install expect
</pre>

<p>
或
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ apt-get install expect
</pre>

<h1 id="toc_2">日期时间</h1>

<h2 id="toc_2.1">cal</h2>

<pre class="brush: bash">
cal
cal 02 1995
</pre>

<h2 id="toc_2.2">date</h2>

<p>
取得时间：
</p>

<pre class="brush: bash">
root@tecmint:~# date
 
Fri May 17 14:13:29 IST 2013
</pre>
	
<p>
设置时间：
</p>

<pre class="brush: bash">
root@tecmint:~# date --set='14 may 2013 13:57'
 
Mon May 13 13:57:00 IST 2013
</pre>

<h1 id="toc_3">别名</h1>

<h2 id="toc_3.1">alias</h2>

<p>
<code>alias</code>是一个系统自建的shell命令，允许你为名字比较长的或者经常使用的命令指定别名
。
</p>

<p>
我经常用<code>ls -l</code>命令，它有五个字符（包括空格）。于是我为它创建了一个别名<code>l</code>。
</p>

<pre class="brush: bash">
root@tecmint:~# alias l='ls -l'
</pre>

<p>
试试它是否能用：
</p>

<pre class="brush: bash">
root@tecmint:~# l
 
total 36
drwxr-xr-x 3 tecmint tecmint 4096 May 10 11:14 Binary
drwxr-xr-x 3 tecmint tecmint 4096 May 21 11:21 Desktop
drwxr-xr-x 2 tecmint tecmint 4096 May 21 15:23 Documents
drwxr-xr-x 8 tecmint tecmint 4096 May 20 14:56 Downloads
drwxr-xr-x 2 tecmint tecmint 4096 May  7 16:58 Music
drwxr-xr-x 2 tecmint tecmint 4096 May 20 16:17 Pictures
drwxr-xr-x 2 tecmint tecmint 4096 May  7 16:58 Public
drwxr-xr-x 2 tecmint tecmint 4096 May  7 16:58 Templates
drwxr-xr-x 2 tecmint tecmint 4096 May  7 16:58 Videos
</pre>

<p>
去掉<code>l</code>别名，要使用<code>unalias</code>命令：
</p>

<pre class="brush: bash">
root@tecmint:~# unalias l
</pre>

<p>
再试试：
</p>

<pre class="brush: bash">
root@tecmint:~# l
 
bash: l: command not found
</pre>

<h1 id="toc_4">通信</h1>

<h2 id="toc_4.1">wall</h2>

<p>
对系统管理员来说一个最重要的命令.<code>wall</code>发送一条消息到大家登录端将其<code>mesg</code>权限
设置为<code>yes</code>。这条信息可以被<code>wall</code>作为参数，或者可以将它作为<code>wall</code>的标准输入。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ wall "we will be going down for maintenance for one hour sharply at 03:30 pm"
Broadcast message from root@localhost.localdomain (pts/0) (Sat Jun 29 14:44:02 2013):
we will be going down for maintenance for one hour sharply at 03:30 pm
</pre>

<h2 id="toc_4.2">mesg</h2>

<p>
其他人们可以使用<code>wtrite</code>命令,将在在向您发送文本到屏幕上。你可以控制是否显示。
</p>

<pre class="brush: bash">
mesg [&lt;strong&gt;n&lt;/strong&gt;|&lt;strong&gt;y&lt;/strong&gt;] &lt;strong&gt;n&lt;/strong&gt; - prevents the message from others popping up on the screen. &lt;strong&gt;y&lt;/strong&gt; – Allows messages to appear on your screen.
</pre>

<h2 id="toc_4.3">write</h2>

<p>
如果<code>mesg</code>是<code>y</code>，让你的文本直接发送到另一台Linux机器的屏幕。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ write ravisaive
</pre>

<h2 id="toc_4.4">talk</h2>

<p>
增强的<code>write</code>命令，talk命令可让你与其他登录的用户交谈。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ talk ravisaive
</pre>


<h1 id="toc_5">系统信息</h1>

<h2 id="toc_5.1">uptime</h2>

<p>
你连接到你的Linux服务器时发现一些不寻常或恶意的东西，你会做什么？猜测……不，绝不
！你可以运行<code>uptime</code>来验证当服务器无人值守式到底发生了什么事情。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ uptime
 
14:37:10 up  4:21,  2 users,  load average: 0.00, 0.00, 0.04
</pre>


<h2 id="toc_5.2">uname</h2>

<p>
<code>uname</code>命令就是Unix Name的简写。显示机器名，操作系统和内核的详细信息。
</p>

<pre class="brush: bash">
root@tecmint:~# uname -a
 
Linux tecmint 3.8.0-19-generic #30-Ubuntu SMP Wed May 1 16:36:13 UTC 2013 i686 i686 i686 GNU/Linux
</pre>

<p>
<code>uname</code>显示内核类别， <code>uname -a</code>显示详细信息：
</p>

<ol>
<li>
<code>Linux</code>: 机器的内核名

<li>
<code>tecmint</code>: 机器的分支名

<li>
<code>3.8.0-19-generic</code>: 内核发布版本

<li>
<code>#30-Ubuntu SMP</code>: 内核版本

<li>
<code>i686</code>: 处理器架构

<li>
<code>GNU/Linux</code>: 操作系统名

</ol>

<h2 id="toc_5.3">issue</h2>

<p>
<code>cat /etc/issue</code>
</p>

<h2 id="toc_5.4">w</h2>

<p>
是否觉得命令<code>w</code>很滑稽？但是事实上不是的。它是一个命令，尽管只有一个字符长，命令
<code>w</code>是<code>uptime</code>和<code>who</code>命令，以前后的顺序组合在一起。
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ w
 
15:05:42 up  4:49,  3 users,  load average: 0.02, 0.01, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
server   tty7     :0               14:06    4:43m  1:42   0.08s pam: gdm-passwo
server   pts/0    :0.0             14:18    0.00s  0.23s  1.65s gnome-terminal
server   pts/1    :0.0             14:47    4:43   0.01s  0.01s bash
</pre>
 
<h2 id="toc_5.5">whereis</h2>

<p>
<code>whereis</code>的作用是用来定位命令的二进制文件\资源\或者帮助页，举例来说，获得<code>ls</code>和
<code>kill</code>命令的二进制文件/资源以及帮助页：
</p>

<pre class="brush: bash">
root@tecmint:~# whereis ls
 
ls: /bin/ls /usr/share/man/man1/ls.1.gz

root@tecmint:~# whereis kill
 
kill: /bin/kill /usr/share/man/man2/kill.2.gz /usr/share/man/man1/kill.1.gz
</pre>

<p>
注意:当需要知道二进制文件保存位置时有用.
</p>

<h1 id="toc_6">用户管理</h1>

<p>
修改用户配置：
</p>

<pre class="brush: bash">
usermod  [-u uid [-o]] [-g group] [-G group,...]
	[-d 主目录 [-m]] [-s shell] [-c 注释] [-l 新名称]
	[-f 失效日] [-e 过期日] [-p 密码] [-L|-U] 用户名
</pre>



<h1 id="toc_7">软件安装</h1>

<p>
<a href="linux.base.dpkg.html">linux.base.dpkg</a>
</p>

<h1 id="toc_8">文件系统</h1>

<p>
<a href="linux.base.filesystem.html">linux.base.filesystem</a>
</p>

<h1 id="toc_9">任务管理</h1>

<h2 id="toc_9.1">jobs</h2>

<p>
中断任务：<code>Control + C</code>
</p>

<p>
挂起任务：<code>Control + Z</code>
</p>

<p>
显示当前任务的作业号<code>q：jobs</code>
</p>

<p>
指定任务８在后台执行
</p>
<pre class="brush: bash">
bg %8
</pre>

<p>
指定任务８在前台执行
</p>
<pre class="brush: bash">
fg %8
</pre>


<h1 id="toc_10">进程管理</h1>

<h2 id="toc_10.1">top</h2>

<h3 id="toc_10.1.1">排序</h3>

<p>
Sorting with <code>-O</code> (Uppercase Letter <code>O</code>).
</p>

<p>
Press <code>Shift+O</code> to Sort field via field letter, for example press <code>a</code> letter to 
sort process with PID (Process ID).
</p>

<p>
Type any key to return to main top window with sorted PID order as shown in 
below screen. Press <code>q</code> to quit exit the window. Sorting Process ID's
</p>

<h3 id="toc_10.1.2">Display Specific User Process</h3>

<p>
Use top command with <code>u</code> option will display specific User process details.
</p>

<pre class="brush: bash">
# top -u tecmint
</pre>

<h3 id="toc_10.1.3">Highlight Running Process in Top</h3>

<p>
Press <code>z</code> option in running <code>top</code> command will display running process in color 
which may help you to identified running process easily.
</p>

<h3 id="toc_10.1.4">Shows Absolute Path of Processes</h3>

<p>
Press <code>c</code> option in running <code>top</code> command, it will display absolute path of 
running process.
</p>

<h3 id="toc_10.1.5">Change Delay or Set ‘Screen Refresh Interval’ in Top</h3>

<p>
By default screen refresh interval is 3.0 seconds, same can be change pressing 
<code>d</code> option in running top command and change it as desired as shown below.
</p>

<h3 id="toc_10.1.6">Kill running process</h3>

<p>
Kill running process with argument <code>k</code>
</p>

<p>
You can kill a process after finding PID of process by pressing <code>k</code> option in 
running top command without exiting from top window as shown below.
</p>

<h3 id="toc_10.1.7">Sort by CPU Utilisation</h3>

<p>
Press <code>Shift+P</code> to sort processes as per CPU utilization. See screenshot below.
</p>

<h3 id="toc_10.1.8">Renice a Process</h3>

<p>
You can use <code>r</code> option to change the priority of the process also called Renice.
</p>

<h3 id="toc_10.1.9">Save Top Command Results</h3>

<p>
Press <code>Shift+W</code> to save the running top command results under <code>/root/.toprc</code>.
</p>


<h2 id="toc_10.2">free</h2>

<p>
跟踪内存的使用和资源一样重要，就像管理员执行的任何其它任务，可以使用<code>free</code>命令
来在这里救援.当前内存使用状态Current Usage Status of Memory
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ free
 
             total       used       free     shared    buffers     cached
Mem:       2028240    1788272     239968          0      69468     363716
-/+ buffers/cache:    1355088     673152
Swap:      3905532     157076    3748456
</pre>

<p>
设置输出单位为KB，MB或GB
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -b
 
             total       used       free     shared    buffers     cached
Mem:    2076917760 1838272512  238645248          0   71348224  372670464
-/+ buffers/cache: 1394253824  682663936
Swap:   3999264768  160845824 3838418944
</pre>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -k
 
             total       used       free     shared    buffers     cached
Mem:       2028240    1801484     226756          0      69948     363704
-/+ buffers/cache:    1367832     660408
Swap:      3905532     157076    3748456
</pre>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -m
 
             total       used       free     shared    buffers     cached
Mem:          1980       1762        218          0         68        355
-/+ buffers/cache:       1338        641
Swap:         3813        153       3660
</pre>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -g
 
             total       used       free     shared    buffers     cached
Mem:             1          1          0          0          0          0
-/+ buffers/cache:          1          0
Swap:            3          0          3
</pre>

<p>
以可读的格式显示，检查当前内存使用
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -h
 
             total       used       free     shared    buffers     cached
Mem:          1.9G       1.7G       208M         0B        68M       355M
-/+ buffers/cache:       1.3G       632M
Swap:         3.7G       153M       3.6G
</pre>

<p>
设定时间间隔后，持续检查使用状态
</p>

<pre class="brush: bash">
[avishek@tecmint ~]$ free -s 3
 
             total       used       free     shared    buffers     cached
Mem:       2028240    1824096     204144          0      70708     364180
-/+ buffers/cache:    1389208     639032
Swap:      3905532     157076    3748456
 
             total       used       free     shared    buffers     cached
Mem:       2028240    1824192     204048          0      70716     364212
-/+ buffers/cache:    1389264     638976
Swap:      3905532     157076    3748456
</pre>



<h2 id="toc_10.3">kill</h2>

<p>
假设你想杀死已经没有响应的<code>apache2</code>进程,运行如下命令:
</p>

<pre class="brush: bash">
root@tecmint:~# ps -A | grep -i apache2
 
1285 ?        00:00:00 apache2
</pre>

<p>
搜索<code>apache2</code>进程,找到PID并杀掉它.例如:在本例中<code>apache2</code>进程的PID是1285..
</p>

<pre class="brush: bash">
root@tecmint:~# kill 1285
</pre>

<p>
注意:每次你重新运行一个进程或者启动系统,每个进程都会生成一个新的PID.你可以使用
<code>ps</code>命令获得当前运行进程的PID.
</p>

<h2 id="toc_10.4">pkill</h2>

<p>
另一个杀死进程的方法是:
</p>
	
<pre class="brush: bash">
root@tecmint:~# pkill apache2
</pre>

<p>
注意:kill需要PID作为参数,pkill可以选择应用的方式,比如指定进程的所有者等.
</p>

<h1 id="toc_11">服务</h1>

<h2 id="toc_11.1">service</h2>

<p>
<code>service</code>命令控制服务的启动、停止和重启，它让你能够不重启整个系统就可以让配置
生效以开启、停止或者重启某个服务。
</p>

<p>
在Ubuntu上启动apache2 server：
</p>

<pre class="brush: bash">
root@tecmint:~# service apache2 start
 
 * Starting web server apache2                                                                                                                                 apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName
httpd (pid 1285) already running                        [ OK ]
</pre>

<p>
重启apache2 server：
</p>

<pre class="brush: bash">
root@tecmint:~# service apache2 restart
 
* Restarting web server apache2                                                                                                                               apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName
 ... waiting .apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName  [ OK ]
</pre>

<p>
停止apache2 server：
</p>

<pre class="brush: bash">
root@tecmint:~# service apache2 stop
 
 * Stopping web server apache2                                                                                                                                 apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName
 ... waiting                                                                [ OK ]
</pre>

<p>
注意：要想使用<code>service</code>命令，进程的脚本必须放在<code>/etc/init.d</code>，并且路径必须在指定
的位置。
</p>

<p>
如果要运行<code>service apache2 start</code>实际上实在执行
</p>

<pre class="brush: bash">
service /etc/init.d/apache2 start
</pre>

<h1 id="toc_12">文件资源</h1>


<h2 id="toc_12.1">lsof</h2>

<p>
<code>lsof</code>是"list open files("列表中打开的文件") 的缩写，显示您的系统当前已打开的
所有文件。
</p>

<h3 id="toc_12.1.1">List all Open Files with lsof Command</h3>

<p>
In the below example, it will show long listing of open files some of them are 
extracted for better understanding which displays the columns like Command, PID,
USER, FD, TYPE etc.
</p>

<pre class="brush: bash">
# lsof

COMMAND    PID      USER   FD      TYPE     DEVICE  SIZE/OFF       NODE NAME
init         1      root  cwd      DIR      253,0      4096          2 /
init         1      root  rtd      DIR      253,0      4096          2 /
init         1      root  txt      REG      253,0    145180     147164 /sbin/init
init         1      root  mem      REG      253,0   1889704     190149 /lib/libc-2.12.so
init         1      root   0u      CHR        1,3       0t0       3764 /dev/null
init         1      root   1u      CHR        1,3       0t0       3764 /dev/null
init         1      root   2u      CHR        1,3       0t0       3764 /dev/null
init         1      root   3r     FIFO        0,8       0t0       8449 pipe
init         1      root   4w     FIFO       0,8       0t0       8449 pipe
init         1      root   5r      DIR       0,10         0          1 inotify
init         1      root   6r      DIR       0,10         0          1 inotify
init         1      root   7u     unix 0xc1513880       0t0       8450 socket
</pre>

<p>
Sections and it’s values are self-explanatory. However, we’ll review FD &amp; TYPE 
columns more precisely.
</p>

<p>
FD – stands for File descriptor and may seen some of the values as:
</p>

<ul>
<li>
<code>cwd</code> current working directory

<li>
<code>rtd</code> root directory

<li>
<code>txt</code> program text (code and data)

<li>
<code>mem</code> memory-mapped file

</ul>

<p>
Also in <code>FD</code> column numbers like 1u is actual file descriptor and followed by 
u,r,w of it’s mode as:
</p>

<ul>
<li>
 <code>r</code> for read access.

<li>
 <code>w</code> for write access.

<li>
 <code>u</code> for read and write access.

</ul>

<p>
<code>TYPE</code> – of files and it’s identification.
</p>

<ul>
<li>
<code>DIR</code> – Directory

<li>
<code>REG</code> – Regular file

<li>
<code>CHR</code> – Character special file.

<li>
<code>FIFO</code> – First In First Out

</ul>

<h3 id="toc_12.1.2">List User Specific Opened Files</h3>

<p>
The below command will display the list of all opened files of user tecmint.
</p>

<pre class="brush: bash">
# lsof -u tecmint

COMMAND  PID    USER   FD   TYPE     DEVICE SIZE/OFF   NODE NAME
sshd    1838 tecmint  cwd    DIR      253,0     4096      2 /
sshd    1838 tecmint  rtd    DIR      253,0     4096      2 /
sshd    1838 tecmint  txt    REG      253,0   532336 188129 /usr/sbin/sshd
sshd    1838 tecmint  mem    REG      253,0    19784 190237 /lib/libdl-2.12.so
sshd    1838 tecmint  mem    REG      253,0   122436 190247 /lib/libselinux.so.1
sshd    1838 tecmint  mem    REG      253,0   255968 190256 /lib/libgssapi_krb5.so.2.2
sshd    1838 tecmint  mem    REG      253,0   874580 190255 /lib/libkrb5.so.3.3
</pre>

<h3 id="toc_12.1.3">Find Processes running on Specific Port</h3>

<p>
To find out all the running process of specific port, just use the following 
command with option <code>-i</code>. The below example will list all running process of 
port 22.
</p>

<pre class="brush: bash">
# lsof -i TCP:22

COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
sshd    1471    root    3u  IPv4  12683      0t0  TCP *:ssh (LISTEN)
sshd    1471    root    4u  IPv6  12685      0t0  TCP *:ssh (LISTEN)
</pre>

<h3 id="toc_12.1.4">List Only IPv4 &amp; IPv6 Open Files</h3>

<p>
In below example shows only IPv4 and IPv6 network files open with separate 
commands.
</p>

<pre class="brush: bash">
# lsof -i 4

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
rpcbind   1203     rpc    6u  IPv4  11326      0t0  UDP *:sunrpc
rpcbind   1203     rpc    7u  IPv4  11330      0t0  UDP *:954
rpcbind   1203     rpc    8u  IPv4  11331      0t0  TCP *:sunrpc (LISTEN)
avahi-dae 1241   avahi   13u  IPv4  11579      0t0  UDP *:mdns
avahi-dae 1241   avahi   14u  IPv4  11580      0t0  UDP *:58600
</pre>

<pre class="brush: bash">
# lsof -i 6

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
rpcbind   1203     rpc    9u  IPv6  11333      0t0  UDP *:sunrpc
rpcbind   1203     rpc   10u  IPv6  11335      0t0  UDP *:954
rpcbind   1203     rpc   11u  IPv6  11336      0t0  TCP *:sunrpc (LISTEN)
rpc.statd 1277 rpcuser   10u  IPv6  11858      0t0  UDP *:55800
rpc.statd 1277 rpcuser   11u  IPv6  11862      0t0  TCP *:56428 (LISTEN)
cupsd     1346    root    6u  IPv6  12112      0t0  TCP localhost:ipp (LISTEN)
</pre>

<h3 id="toc_12.1.5">List Open Files of TCP Port ranges 1-1024</h3>

<p>
To list all the running process of open files of TCP Port ranges from 1-1024.
</p>

<pre class="brush: bash">
# lsof -i TCP:1-1024

COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
rpcbind 1203     rpc   11u  IPv6  11336      0t0  TCP *:sunrpc (LISTEN)
cupsd   1346    root    7u  IPv4  12113      0t0  TCP localhost:ipp (LISTEN)
sshd    1471    root    4u  IPv6  12685      0t0  TCP *:ssh (LISTEN)
master  1551    root   13u  IPv6  12898      0t0  TCP localhost:smtp (LISTEN)
sshd    1834    root    3r  IPv4  15101      0t0  TCP 192.168.0.2:ssh-&gt;192.168.0.1:conclave-cpp (ESTABLISHED)
sshd    1838 tecmint    3u  IPv4  15101      0t0  TCP 192.168.0.2:ssh-&gt;192.168.0.1:conclave-cpp (ESTABLISHED)
sshd    1871    root    3r  IPv4  15842      0t0  TCP 192.168.0.2:ssh-&gt;192.168.0.1:groove (ESTABLISHED)
httpd   1918    root    5u  IPv6  15991      0t0  TCP *:http (LISTEN)
httpd   1918    root    7u  IPv6  15995      0t0  TCP *:https (LISTEN)
</pre>

<h3 id="toc_12.1.6">Exclude User with ‘^’ Character</h3>

<p>
Here, we have excluded root user. You can exclude a particular user using <code>^</code> 
with command as shown above.
</p>

<pre class="brush: bash">
# lsof -i -u^root

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
rpcbind   1203     rpc    6u  IPv4  11326      0t0  UDP *:sunrpc
rpcbind   1203     rpc    7u  IPv4  11330      0t0  UDP *:954
rpcbind   1203     rpc    8u  IPv4  11331      0t0  TCP *:sunrpc (LISTEN)
rpcbind   1203     rpc    9u  IPv6  11333      0t0  UDP *:sunrpc
rpcbind   1203     rpc   10u  IPv6  11335      0t0  UDP *:954
rpcbind   1203     rpc   11u  IPv6  11336      0t0  TCP *:sunrpc (LISTEN)
avahi-dae 1241   avahi   13u  IPv4  11579      0t0  UDP *:mdns
avahi-dae 1241   avahi   14u  IPv4  11580      0t0  UDP *:58600
rpc.statd 1277 rpcuser    5r  IPv4  11836      0t0  UDP *:soap-beep
rpc.statd 1277 rpcuser    8u  IPv4  11850      0t0  UDP *:55146
rpc.statd 1277 rpcuser    9u  IPv4  11854      0t0  TCP *:32981 (LISTEN)
rpc.statd 1277 rpcuser   10u  IPv6  11858      0t0  UDP *:55800
rpc.statd 1277 rpcuser   11u  IPv6  11862      0t0  TCP *:56428 (LISTEN)
</pre>

<h3 id="toc_12.1.7">Find Out who’s Looking What Files and Commands?</h3>

<p>
Below example shows user tecmint is using command like ping and <code>/etc</code> 
directory .
</p>

<pre class="brush: bash">
# lsof -i -u tecmint

COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
bash    1839 tecmint  cwd    DIR  253,0    12288   15 /etc
ping    2525 tecmint  cwd    DIR  253,0    12288   15 /etc
</pre>

<h3 id="toc_12.1.8">List all Network Connections</h3>

<p>
The following command with option <code>-i</code> shows the list of all network connections
‘LISTENING &amp; ESTABLISHED’.
</p>

<pre class="brush: bash">
# lsof -i

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
rpcbind   1203     rpc    6u  IPv4  11326      0t0  UDP *:sunrpc
rpcbind   1203     rpc    7u  IPv4  11330      0t0  UDP *:954
rpcbind   1203     rpc   11u  IPv6  11336      0t0  TCP *:sunrpc (LISTEN)
avahi-dae 1241   avahi   13u  IPv4  11579      0t0  UDP *:mdns
avahi-dae 1241   avahi   14u  IPv4  11580      0t0  UDP *:58600
rpc.statd 1277 rpcuser   11u  IPv6  11862      0t0  TCP *:56428 (LISTEN)
cupsd     1346    root    6u  IPv6  12112      0t0  TCP localhost:ipp (LISTEN)
cupsd     1346    root    7u  IPv4  12113      0t0  TCP localhost:ipp (LISTEN)
sshd      1471    root    3u  IPv4  12683      0t0  TCP *:ssh (LISTEN)
master    1551    root   12u  IPv4  12896      0t0  TCP localhost:smtp (LISTEN)
master    1551    root   13u  IPv6  12898      0t0  TCP localhost:smtp (LISTEN)
sshd      1834    root    3r  IPv4  15101      0t0  TCP 192.168.0.2:ssh-&gt;192.168.0.1:conclave-cpp (ESTABLISHED)
httpd     1918    root    5u  IPv6  15991      0t0  TCP *:http (LISTEN)
httpd     1918    root    7u  IPv6  15995      0t0  TCP *:https (LISTEN)
clock-app 2362   narad   21u  IPv4  22591      0t0  TCP 192.168.0.2:45284-&gt;www.gov.com:http (CLOSE_WAIT)
chrome    2377   narad   61u  IPv4  25862      0t0  TCP 192.168.0.2:33358-&gt;maa03s04-in-f3.1e100.net:http (ESTABLISHED)
chrome    2377   narad   80u  IPv4  25866      0t0  TCP 192.168.0.2:36405-&gt;bom03s01-in-f15.1e100.net:http (ESTABLISHED)
</pre>

<h3 id="toc_12.1.9">Search by PID</h3>

<p>
The below example only shows whose PID is 1 [One].
</p>

<pre class="brush: bash">
# lsof -p 1

COMMAND PID USER   FD   TYPE     DEVICE SIZE/OFF   NODE NAME
init      1 root  cwd    DIR      253,0     4096      2 /
init      1 root  rtd    DIR      253,0     4096      2 /
init      1 root  txt    REG      253,0   145180 147164 /sbin/init
init      1 root  mem    REG      253,0  1889704 190149 /lib/libc-2.12.so
init      1 root  mem    REG      253,0   142472 189970 /lib/ld-2.12.so
</pre>

<h3 id="toc_12.1.10">Kill all Activity of Particular User</h3>

<pre class="brush: bash">
Sometimes you may have to kill all the processes for a specific user. Below 
command will kills all the processes of tecmint user.

# kill -9 `lsof -t -u tecmint`
</pre>

<p>
Note: Here, it’s not possible to give example of all available options, this 
guide is only to show how lsof command can be use. You may refer man page of 
<code>lsof</code> command to know more about it. Please share it if you find this article 
is useful through our comment box below.
</p>




<h1 id="toc_13">文件操作</h1>

<h2 id="toc_13.1">散列</h2>

<pre class="brush: bash">
echo "yangpan220" | md5sum
</pre>

<p>
注意上面的echo会自动加上一个回车。可以用-n去掉：
</p>

<pre class="brush: bash">
echo -n 'yangpan220' | md5sum
</pre>


<h2 id="toc_13.2">压缩</h2>

<p>
<a href="linux.base.compress.html">linux.base.compress</a>
</p>


<h2 id="toc_13.3">查找</h2>

<p>
<a href="linux.base.search.html">linux.base.search</a>
</p>

<h1 id="toc_14">文本文件</h1>

<h2 id="toc_14.1">paste</h2>

<p>
合并两个或多个文本文件，按行来进行合并。示例。如果<code>file1</code>的内容是：
</p>

<pre class="brush: bash">
1
2
3
</pre>

<p>
<code>file2</code>是这样的:
</p>

<pre class="brush: bash">
a
b
c
d
</pre>
	
<pre class="brush: bash">
[avishek@tecmint ~]$ paste file1 file2 &gt; file3
</pre>

<p>
结果<code>file3</code>将是:
</p>

<pre class="brush: bash">
1    a
2    b
3    c
     d
</pre>

<h2 id="toc_14.2">比较</h2>

<p>
<code>cmp</code>比较两个任意类型的文件并将结果输出至标准输出。如果两个文件相同， <code>cmp</code>默认
返回<code>0</code>；如果不同，将显示不同的字节数和第一处不同的位置。
</p>

<p>
以下面两个文件为例：
</p>

<p>
<code>file1.txt</code>
</p>

<pre class="brush: bash">
root@tecmint:~# cat file1.txt
 
Hi My name is Tecmint
</pre>

<p>
<code>file2.txt</code>
</p>

<pre class="brush: bash">
root@tecmint:~# cat file2.txt
 
Hi My name is tecmint [dot] com
</pre>

<p>
比较一下这两个文件，看看命令的输出。
</p>

<pre class="brush: bash">
root@tecmint:~# cmp file1.txt file2.txt
 
file1.txt file2.txt differ: byte 15, line 1
</pre>

<h2 id="toc_14.3">编码与格式</h2>

<h3 id="toc_14.3.1">ASCII</h3>

<p>
<code>main ascii</code>可以直接查看OCT或HEX的ascii表。
</p>

<h3 id="toc_14.3.2">生成16f进制</h3>

<p>
<code>xxd</code>可以生成16进制：
</p>

<pre class="brush: bash">
$ xxd vab.txt 
0000000: 4e61 6d69 6e67 2043 6f6e 7665 6e74 696f  Naming Conventio
0000010: 6e73 efbc 88e8 a784 e88c 83ef bc8c e58d  ns..............
0000020: 8fe8 aeae efbc 890d 0a0d 0a64 6973 636f  ...........disco
0000030: 7572 6167 6564 20e6 b094 e9a6 81ef bc8c  uraged .........
0000040: e4bd bfe5 8a9d e998 bb0d 0a0d 0a70 656e  .............pen
0000050: 6461 6e74 20e8 8bb1 205b cb88 7065 6e64  dant ... [..pend
0000060: c999 6e74 5d20 e7be 8e20 5bcb 8870 c99b  ..nt] ... [..p..
0000070: 6e64 c999 6e74 5d20 6e2e efbc 88e8 a385  nd..nt] n.......
0000080: e59c a8e9 a1b9 e993 bee7 ad89 e4b8 8ae7  ................
0000090: 9a84 efbc 89e5 9e82 e9a5 b0ef bc8c e59d  ................
00000a0: a0e5 84bf 0d0a                           ......
</pre>

<p>
还可以把二六进制还原为二进制。甚至把十六进制拷贝输出成C数组：
</p>

<pre class="brush: bash">
$ xxd -i vab.txt  
unsigned char vab_txt[] = {
  0x4e, 0x61, 0x6d, 0x69, 0x6e, 0x67, 0x20, 0x43, 0x6f, 0x6e, 0x76, 0x65,
  0x6e, 0x74, 0x69, 0x6f, 0x6e, 0x73, 0xef, 0xbc, 0x88, 0xe8, 0xa7, 0x84,
  0xe8, 0x8c, 0x83, 0xef, 0xbc, 0x8c, 0xe5, 0x8d, 0x8f, 0xe8, 0xae, 0xae,
  0xef, 0xbc, 0x89, 0x0d, 0x0a, 0x0d, 0x0a, 0x64, 0x69, 0x73, 0x63, 0x6f,
  0x75, 0x72, 0x61, 0x67, 0x65, 0x64, 0x20, 0xe6, 0xb0, 0x94, 0xe9, 0xa6,
  0x81, 0xef, 0xbc, 0x8c, 0xe4, 0xbd, 0xbf, 0xe5, 0x8a, 0x9d, 0xe9, 0x98,
  0xbb, 0x0d, 0x0a, 0x0d, 0x0a, 0x70, 0x65, 0x6e, 0x64, 0x61, 0x6e, 0x74,
  0x20, 0xe8, 0x8b, 0xb1, 0x20, 0x5b, 0xcb, 0x88, 0x70, 0x65, 0x6e, 0x64,
  0xc9, 0x99, 0x6e, 0x74, 0x5d, 0x20, 0xe7, 0xbe, 0x8e, 0x20, 0x5b, 0xcb,
  0x88, 0x70, 0xc9, 0x9b, 0x6e, 0x64, 0xc9, 0x99, 0x6e, 0x74, 0x5d, 0x20,
  0x6e, 0x2e, 0xef, 0xbc, 0x88, 0xe8, 0xa3, 0x85, 0xe5, 0x9c, 0xa8, 0xe9,
  0xa1, 0xb9, 0xe9, 0x93, 0xbe, 0xe7, 0xad, 0x89, 0xe4, 0xb8, 0x8a, 0xe7,
  0x9a, 0x84, 0xef, 0xbc, 0x89, 0xe5, 0x9e, 0x82, 0xe9, 0xa5, 0xb0, 0xef,
  0xbc, 0x8c, 0xe5, 0x9d, 0xa0, 0xe5, 0x84, 0xbf, 0x0d, 0x0a
};
unsigned int vab_txt_len = 166;
</pre>

<h3 id="toc_14.3.3">字符编码</h3>

<p>
转换单个文件：
</p>

<pre class="brush: bash">
iconv -f GBK -t UTF-8 tt.json &gt; tt.json
</pre>

<p>
把当前目录下的文件转换编码：
</p>

<pre class="brush: bash">
sed -i "s/old/new/g" `grep old -rl ./`
</pre>

<p>
或是：
</p>

<pre class="brush: bash">
`enca -L zh_CN -x utf-8 *`
</pre>

<h3 id="toc_14.3.4">换行</h3>

<p>
Windows文本文件的<code>^M</code>，注意这个<code>^M</code>的输入方式为<code>CTRL v CTRL m</code>。
</p>

<p>
使用<code>dos2unix</code>命令:
</p>

<pre class="brush: bash">
$ dos2unix myfile.txt
</pre>

<p>
使用sed命令：
</p>

<pre class="brush: bash">
$ sed -e ‘s/^M/\n/g’ myfile.txt
</pre>
 </div>
</body>
</html>
